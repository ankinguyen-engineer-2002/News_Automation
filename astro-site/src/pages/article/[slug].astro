---
import Layout from "@/layouts/Layout.astro";
import Container from "@/components/container.astro";
import { getCollection, render } from "astro:content";

export async function getStaticPaths() {
  const articles = await getCollection("articles");
  return articles.map(article => ({
    params: { slug: article.slug },
    props: { article },
  }));
}

const { article } = Astro.props;
const { Content } = await render(article);

const topicIcons: Record<string, string> = {
  'microsoft': 'ğŸ”·',
  'data-platform': 'ğŸ”¶',
  'analytics-engineering': 'ğŸŸ¢',
  'ai-agents': 'ğŸŸ£',
  'automation': 'ğŸ”´',
  'github': 'âšª',
};
---

<Layout title={article.data.title}>
  <Container>
    <article class="py-12 max-w-3xl mx-auto">
      <!-- Header -->
      <div class="mb-8">
        <a href={`/topics/${article.data.topic}`} class="text-sm text-slate-500 hover:text-slate-700 mb-2 inline-block">
          â† {topicIcons[article.data.topic]} Back to topic
        </a>
        
        <div class="flex items-center gap-2 mb-4 text-sm text-slate-500">
          <span class="font-mono bg-slate-900 text-white px-2 py-0.5 rounded text-xs">
            #{String(article.data.number).padStart(2, '0')}
          </span>
          <span>{article.data.date}</span>
          <span>Â·</span>
          <span>{article.data.source}</span>
        </div>
        
        <h1 class="text-3xl font-bold text-slate-900 mb-2" data-lang-en>
          {article.data.title}
        </h1>
        {article.data.title_vi && (
          <h1 class="text-3xl font-bold text-slate-900 mb-2 hidden" data-lang-vi>
            {article.data.title_vi}
          </h1>
        )}
        
        <a 
          href={article.data.url}
          target="_blank"
          rel="noopener noreferrer"
          class="inline-flex items-center gap-1 text-indigo-600 hover:underline"
        >
          Read original article â†’
        </a>
      </div>
      
      <!-- Content -->
      <div class="prose prose-slate max-w-none">
        <Content />
      </div>
    </article>
  </Container>
</Layout>
